<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Page Template</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
    </head>
    <body>
        <script type="text/javascript">
		var width = 918,
		height = 800;

		//Define map projection
		var projection = d3.geo.mercator()
			.scale(250000)
			.center([-122.433701, 37.767683])
			.translate([width / 2, height / 2]);
		
		//Define path generator
		var path = d3.geo.path()
			.projection(projection);
		
		//Create SVG element
		var svg = d3.select("body")
			.append("svg")
			.attr("id", "sfmap")
			.attr("width", width)
			.attr("height", height);
			
		//Load in GeoJSON data
		d3.json("sfpddistricts.json", function(json) {
		
			//Bind data and create one path per GeoJSON feature
			svg.selectAll("path")
				.data(json.features)
				.enter()
				.append("path")
				.attr("d", path)
				.attr("stroke", "black")
				.style("fill", "steelblue");
		});
		
		var numberOfCenters;
		var centers = [];
		
		function CreatePoints(data){
			numberOfCenters = data[0].Clusters;
			for (var i =0;i<data.length;i++){
				if (!centers[data[i].Label]) {
					centers[data[i].Label]={"Label": data[i].Label,"X": data[i].X,"Y": data[i].Y};
					if(numberOfCenters+1===Object.keys(centers).length){
						break;
					}
				}
			}
			
			svg.selectAll("circle")
				   .data(data)
				   .enter()
				   .append("circle")
				   .attr("cx", function(d) {
						   return projection([+d.X, +d.Y])[0];
				   })
				   .attr("cy", function(d) {
						   return projection([+d.X, +d.Y])[1];
				   })
				   .attr("r", 5)
				   .style("fill", function(d){
								if (+d.Label === 0)
									return "yellow";
								if (+d.Label === 1)
									return "red";
								if (+d.Label === 2)
									return "green";
								if (+d.Label === 3)
									return "purple";
								if (+d.Label === 4)
									return "hotpink";
								if (+d.Label === 5)
									return "saddlebrown";
				   })
				   .style("opacity", 0.75);
				
				console.log(centers);
				
				svg.selectAll(".centers")
				   .data(centers)
				   .enter()
				   .append("circle")
				   .attr("class","centers")
				   .attr("cx", function(d) {
							console.log(d);
						   return projection([+d.X, +d.Y])[0];
				   })
				   .attr("cy", function(d) {
						   return projection([+d.X, +d.Y])[1];
				   })
				   .attr("r", 7.5)
				   .style("fill", function(d){
								if (+d.Label === 0)
									return "yellow";
								if (+d.Label === 1)
									return "red";
								if (+d.Label === 2)
									return "green";
								if (+d.Label === 3)
									return "purple";
								if (+d.Label === 4)
									return "hotpink";
								if (+d.Label === 5)
									return "saddlebrown";
				   })
				   .style("opacity", 0.75)
				   .style("stroke", "Black")
				   .style("stroke-width", 2);
				   
		}
		
		d3.csv("Kmeans.csv", function(data) {
			CreatePoints(data);
		});
		
        </script>
    </body>
</html>